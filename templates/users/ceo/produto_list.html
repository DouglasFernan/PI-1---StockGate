{% extends 'users/ceo/base.html' %}
{% load static %}
{% block title %}Gerenciar produtos{% endblock %}
{% block head %}
<link rel="stylesheet" href="{% static 'css/ceo/gerenciar_produtos.css' %}">
<script src="{% static 'js/ceo/create_user.js' %}"></script>
{% endblock %}
{% block content %}
<section id="core">
    <div class="top">
        <div class="h5">
            <h5>Gerenciar Produtos</h5>
        </div>
        <div class="form">
            <div>
                <form method="get" action="{% url 'gerenciar_produtos' %}" class="search-form">
                    <input type="text" name="search" placeholder="Busca" value="{{ request.GET.search }}">
                    <button type="submit">Buscar</button>
                </form>
            </div>
            <div>
            <a >
                <button class="btn-new-user" id="open-modal">Novo Produto</button>
            </a>
            </div>
        </div>
    </div>
    <div id="users-container">
        <div class="produtos">
            {% for product in object_list %}
                {% comment %} <div class="inline"> {% endcomment %}
                    <div class="box">
                        <div id="edit-div">
                            <button class="btn-edit">
                                <img src="{% static 'images/ceo/edit.png' %}" alt="Edit"> Editar
                            </button>                                                       
                        </div>
                        <div class="user-photo">
                            <img src="{{ product.product_picture.url }}" alt="Foto de {{ product.name }}" />
                        </div>
                        <div class="product-desc">
                            <div id="product-name">{{product.name}}</div>
                            <div id="product-price">R$ {{product.price}}</div>
                        </div>
                    </div>
                {% comment %} </div> {% endcomment %}
            {% empty %}
                <h5>No data yet</h5>
            {% endfor %}
        </div>
    </div>
</section>
<!-- <section class="modal">
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="top-2">
            <div class="area-1">
                <input type="text" name="name" placeholder="Nome do Produto" required>
                <input type="number" step="0.01" name="price" placeholder="Preço" required>
                <input type="number" name="quantity" placeholder="Quantidade" required>
            </div>
            <div class="area-2">
                <select name="fornecedor" required>
                    <option value="" selected>Selecione o Fornecedor</option>
                    {% for fornecedor in fornecedores %}
                    <option value="{{ fornecedor.id }}">{{ fornecedor.name }}</option>
                    {% endfor %}
                </select>
                <select name="categoria" required>
                    <option value="" selected>Selecione a Categoria</option>
                    {% for categoria in categorias %}
                    <option value="{{ categoria.id }}">{{ categoria.name }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>
        <div class="down">
            <div class="area-3">
                <textarea name="description" placeholder="Descrição (opcional)" rows="3"></textarea>
                <input type="file" name="product_picture" accept="image/*">
            </div>
            <div class="area-4">
                <button type="submit" class="btn-new-user-2">Salvar Produto</button>
            </div>
        </div>
    </form>
</section> -->

<section class="modal {% if modal_open %}show{% endif %}">
    <div >
        <form method="post" action="{% url 'gerenciar_produtos' %}" id="form" enctype="multipart/form-data">
            {% csrf_token %}
            <div id="create-user-form">

                <div class="input-item">
                    <label for="{{ form.name.id_for_label }}">Nome</label>
                    <input placeholder="Nome" type="text" id="{{ form.name.id_for_label }}" name="{{ form.name.html_name }}" value="{{ form.name.value|default:'' }}" class="form-control">
                    <div class="error">
                        {% for error in form.name.errors %}
                            <div>{{ error }}</div>
                        {% endfor %}
                    </div>
                </div>

                <div class="input-item">
                    <label for="{{ form.price.id_for_label }}">Preço</label>
                    <input placeholder="Preço" type="number" id="{{ form.price.id_for_label }}" name="{{ form.price.html_name }}" value="{{ form.price.value|default:'' }}" class="form-control">
                    <div class="error">
                        {% for error in form.price.errors %}
                            <div>{{ error }}</div>
                        {% endfor %}
                    </div>
                </div>

                <div class="input-item">
                    <label for="{{ form.quantity.id_for_label }}">Quantidade</label>
                    <input placeholder="Quantidade" type="number" id="{{ form.quantity.id_for_label }}" name="{{ form.quantity.html_name }}" value="{{ form.quantity.value|default:'' }}" class="form-control" maxlength="10">
                    <div class="error">
                        {% for error in form.quantity.errors %}
                            <div>{{ error }}</div>
                        {% endfor %}
                    </div>
                </div>                
                
                <div class="input-item">
                    <label for="{{ form.description.id_for_label }}">Descrição</label>
                    <input placeholder="Descrição" type="textarea" id="{{ form.description.id_for_label }}" name="{{ form.description.html_name }}" value="{{ form.description.value|default:'' }}" class="form-control">
                    <div class="error">
                        {% for error in form.description.errors %}
                            <div>{{ error }}</div>
                        {% endfor %}
                    </div>
                </div>

                <div class="input-item">
                    <label for="{{ form.product_picture.id_for_label }}">Foto do produto</label>
                    <input type="file" id="{{ form.product_picture.id_for_label }}" name="{{ form.product_picture.html_name }}" class="form-control">
                    <div class="error">
                        {% for error in form.product_picture.errors %}
                            <div>{{ error }}</div>
                        {% endfor %}
                    </div>
                </div>

                <div class="input-item">
                    <label for="{{ form.fornecedor.id_for_label }}">Fornecedor</label>
                    <select name="{{ form.fornecedor.html_name }}" id="{{ form.fornecedor.id_for_label }}" class="form-control">
                        {% for fornecedor in form.fornecedor.field.queryset %}
                            <option value="{{ fornecedor.id }}" {% if fornecedor.id in form.fornecedor.value %}selected{% endif %}>{{ fornecedor.name }}</option>
                        {% endfor %}
                    </select>
                    <div class="error">
                        {% for error in form.fornecedor.errors %}
                            <div>{{ error }}</div>
                        {% endfor %}
                    </div>
                </div>

                <div class="input-item">
                    <label for="{{ form.categoria.id_for_label }}">Categoria</label>
                    <select name="{{ form.categoria.html_name }}" id="{{ form.categoria.id_for_label }}" class="form-control">
                        {% for categoria in form.categoria.field.queryset %}
                            <option value="{{ categoria.id }}" {% if categoria.id == form.categoria.value %}selected{% endif %}>{{ categoria.name }}</option>
                        {% endfor %}
                    </select>
                    
                    <div class="error">
                        {% for error in form.categoria.errors %}
                            <div>{{ error }}</div>
                        {% endfor %}
                    </div>
                </div>

            </div>
            <button class="btn-new-user-3" type="submit">Criar Produto</button>
        </form>
    </div>
</section>

{% endblock %}
